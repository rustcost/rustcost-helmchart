# ------------------------------------------------
# Project: Rustcost
# Backend: rustcost-core (Axum)
# Dashboard: rustcost-dashboard (React)
# ------------------------------------------------

# Number of backend replicas
replicaCount: 1

# -----------------------------
# Logging
# -----------------------------
logging:
  level: warn
  moduleLevels: {}

# -----------------------------
# Backend (rustcost-core)
# -----------------------------
image:
  repository: rustcost/core
  tag: "1.0.0"
  pullPolicy: Always

service:
  type: ClusterIP
  port: 80
  targetPort: 3000

resources: {}
# Example:
# resources:
#   requests:
#     cpu: "100m"
#     memory: "128Mi"
#   limits:
#     cpu: "500m"
#     memory: "512Mi"

# -----------------------------
# Persistence (for local data dir)
# -----------------------------
persistence:
  enabled: true
  size: 5Gi
  storageClass: "" # leave empty to use cluster default
  mountPath: /app/data

# -----------------------------
# Dashboard (rustcost-dashboard)
# -----------------------------
dashboard:
  enabled: true
  image:
    repository: rustcost/dashboard
    tag: "1.0.0"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  env:
    VITE_BACKEND_URL: "http://rustcost-core-svc:80"

# -----------------------------
# GPU Exporter (optional)
# -----------------------------
gpuExporter:
  enabled: false
  image:
    repository: rustcost/gpu-exporter
    tag: "0.0.2"
    pullPolicy: IfNotPresent
  port: 8000
  env:
    complex: 0
    collectIntervalSec: 60
  resources:
    limits:
      nvidia.com/gpu: 1
  nodeSelector: {}
  tolerations: []
  affinity: {}

# -----------------------------
# cAdvisor (optional external collector)
# -----------------------------
cadvisor:
  enabled: false
  serviceName: "" # override if you already run a shared cadvisor service
  port: 4194

# -----------------------------
# Ingress (optional)
# -----------------------------
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: rustcost.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# -----------------------------
# RBAC / Service Account
# -----------------------------
rbac:
  enabled: true
  role: viewer # viewer | developer | admin
  serviceAccount:
    create: true
    name: ""

fullnameOverride: rustcost
